# ポケット会計 - 要件定義書

## 1. アプリ概要

### 1.1 目的
実店舗での買い物中に、カゴに入れた商品の合計金額をリアルタイムで把握できるスマートフォン向けWebアプリケーション（PWA）

### 1.2 ターゲットユーザー
- 買い物時の予算管理を重視する一般消費者
- 会計前に合計金額を把握したい利用者
- スマートフォンを日常的に使用する方

### 1.3 解決する課題
- 買い物カゴの中身の合計金額が分からない不安
- 予算オーバーの心配
- レジでの支払い時の驚き

## 2. 機能要件

### 2.1 基本機能

#### 2.1.1 商品登録機能
- **値札撮影機能**
  - カメラで値札を撮影
  - OCR（光学文字認識）による価格自動読み取り
  - 読み取り結果の確認・修正機能
- **手動入力機能**
  - 数字キーパッドによる価格入力
  - 商品名入力（任意）
- **商品情報管理**
  - 商品一覧表示
  - 個別商品の削除機能
  - 数量変更機能

#### 2.1.2 計算機能
- **税設定**
  - 税込/税抜の選択
  - 消費税率設定（デフォルト10%）
- **合計計算**
  - リアルタイム合計金額表示
  - 税額の個別表示
  - 商品点数の表示

#### 2.1.3 データ管理機能
- **セッション管理**
  - 買い物セッションの開始/終了
  - データの一時保存（ローカルストレージ）
  - アプリ再起動時のデータ復元
- **履歴機能**
  - 過去の買い物履歴表示（オプション）
  - セッションデータのクリア

### 2.2 ユーザーインターフェース要件

#### 2.2.1 画面構成
1. **メイン画面**
   - 合計金額表示エリア（大きく）
   - 税込/税抜切り替えボタン
   - 商品追加ボタン（カメラ/手動）
   - 商品一覧エリア
2. **商品追加画面**
   - カメラプレビュー
   - 手動入力フォーム
   - 商品名入力フィールド
3. **設定画面**
   - 税率設定
   - データクリア機能

#### 2.2.2 UI/UX要件
- スマートフォン画面に最適化
- 片手操作を考慮したボタン配置
- 直感的で分かりやすいアイコン使用
- タッチ操作に適したボタンサイズ（44px以上）
- レスポンシブデザイン

## 3. 非機能要件

### 3.1 性能要件
- アプリ起動時間：3秒以内
- OCR処理時間：5秒以内
- 画面遷移：1秒以内

### 3.2 可用性要件
- オフライン動作対応（PWA）
- ネットワーク環境に依存しない基本機能

### 3.3 セキュリティ要件
- 個人情報の外部送信なし
- ローカルデータのみ使用
- HTTPSでの配信

### 3.4 互換性要件
- iOS Safari 12+
- Android Chrome 70+
- 画面サイズ：320px〜428px幅対応

## 4. 技術仕様

### 4.1 アーキテクチャ
- **フロントエンド**: PWA（Progressive Web App）
- **フレームワーク**: React.js / Vue.js（検討中）
- **状態管理**: Context API / Vuex
- **データ保存**: localStorage / IndexedDB

### 4.2 主要技術
- **OCR**: Tesseract.js
- **カメラAPI**: MediaDevices.getUserMedia()
- **UI**: CSS Grid / Flexbox
- **ビルド**: Vite / Webpack

### 4.3 データ構造

```javascript
// 買い物セッション
interface ShoppingSession {
  sessionId: string;
  taxMode: 'included' | 'excluded';
  taxRate: number; // 消費税率（%）
  items: ShoppingItem[];
  totalAmount: number;
  createdAt: string;
  updatedAt: string;
}

// 商品アイテム
interface ShoppingItem {
  id: string;
  name: string;
  price: number;
  quantity: number;
  addedAt: string;
}

// アプリ設定
interface AppSettings {
  defaultTaxRate: number;
  defaultTaxMode: 'included' | 'excluded';
  enableHistory: boolean;
}
```

## 5. 開発段階

### Phase 1（MVP）
- 基本的な手動入力機能
- 税込/税抜計算
- ローカルストレージ保存

### Phase 2
- OCR機能実装
- UI/UX改善
- PWA対応

### Phase 3
- 履歴機能
- 設定カスタマイズ
- パフォーマンス最適化

## 6. 制約事項

- インターネット接続不要で動作
- 外部API依存なし
- データはデバイス内のみ保存
- カメラ機能はHTTPS環境でのみ動作